(function(){Alfresco.dashlet.QuickNavigation=function(t){Alfresco.dashlet.QuickNavigation.superclass.constructor.call(this,t)};YAHOO.extend(Alfresco.dashlet.QuickNavigation,Alfresco.component.SimpleDocList,{getNavigationUrl:function(e){var t=e.fullRepoPath;var n=e.path;var r=e.nodeRef;var i=e.isSiteNode;Alfresco.logger.info("repoRootNode "+this.options.repositoryRootPath);var s={};var o;if(i&&this.options.showInSite){o=n.split("/")[3];s.site=o}Alfresco.logger.info("nodePath: "+t+" | sitePath: "+o);if(i&&o!=undefined){t=t.replace(/(\/[^\/]+){1,4}/,"")}else if(this.options.repositoryRootPath==undefined||this.options.repositoryRootPath==""){t=t.replace(/\/[^\/]+/,"")}t=encodeURIComponent(t);Alfresco.logger.info("nodePath post-norm: "+t);var u;var a=Alfresco.constants.SITE;Alfresco.constants.SITE="";if(this.options.showInBrowse){if(this.options.showInSite&&i&&o!=undefined){u=Alfresco.util.siteURL("documentlibrary#filter=path|"+t+"&page=1",s)}else{u=Alfresco.util.siteURL("repository#filter=path|"+t+"&page=1",s)}}else{u=Alfresco.util.siteURL("folder-details?nodeRef="+r,s)}Alfresco.constants.SITE=a;return u},onReady:function(){var e=this;var t=new YAHOO.util.XHRDataSource(Alfresco.constants.PROXY_URI+"zk-filesystemsuggestion/suggest/spaces");t.responseType=YAHOO.util.XHRDataSource.TYPE_JSON;t.responseSchema={resultsList:"data",fields:["path","nodeRef","fullRepoPath","isSiteNode"]};var n=new YAHOO.widget.AutoComplete(this.id+"-dataInput",this.id+"-dataContainer",t);n.allowBrowserAutocomplete=false;n.forceSelection=true;n.minQueryLength=3;n.maxResultsDisplayed=10;n.generateRequest=function(t){return"?query="+t+"&repositoryRootPath="+e.options.repositoryRootPath+"&includeSites="+e.options.showInSite};n.resultTypeList=false;n.formatResult=function(t,n,r){return"<a href='"+e.getNavigationUrl(t)+"'>"+r+"</a>"};n.dataRequestEvent.subscribe(function(t,n){var r=n[0];var i=document.getElementById(e.id+"-indicator");i.style.display="block";i.innerHTML='<span id="indicator"><img src="'+Alfresco.constants.URL_RESCONTEXT+'/components/dashlets/loading.gif" /></span>'});n.dataReturnEvent.subscribe(function(t,n){var r=n[2];var i=document.getElementById(e.id+"-indicator");if(r.length==0){i.style.display="block";i.innerHTML=e.msg("noResults")}else{i.style.display="none"}});var r=function(t,n){window.location=e.getNavigationUrl(n[2])};n.itemSelectEvent.subscribe(r)}})})()